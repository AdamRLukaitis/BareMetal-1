FIND_PACKAGE(CMSIS REQUIRED)
FIND_PACKAGE(StdPeriphLib REQUIRED)

INCLUDE_DIRECTORIES(
    ${CMAKE_SOURCE_DIR}/include
    ${CMSIS_INCLUDE_DIR}
    ${StdPeriphLib_INCLUDE_DIR}
    ${CMAKE_CURRENT_SOURCE_DIR}
)

SET(BAREMETAL_SPI_SOURCES
    spi_stm32spl.c
)

STM32_GENERATE_LIBRARIES(bm_spi_stm32spl ${BAREMETAL_SPI_SOURCES} BAREMETAL_SPI_LIBRARIES)
INSTALL(TARGETS ${BAREMETAL_SPI_LIBRARIES} RUNTIME DESTINATION bin LIBRARY DESTINATION lib ARCHIVE DESTINATION lib)