FIND_PACKAGE(CMSIS REQUIRED)

INCLUDE_DIRECTORIES(
    ${CMAKE_SOURCE_DIR}/include
    ${CMSIS_INCLUDE_DIR}
    ${CMAKE_CURRENT_SOURCE_DIR}
)

SET(BAREMETAL_DELAY_SOURCES
    delay_stm32spl.c
)

ADD_LIBRARY(bm_delay_stm32spl_cl ${BAREMETAL_DELAY_SOURCES})
SET_TARGET_PROPERTIES(bm_delay_stm32spl_cl PROPERTIES COMPILE_DEFINITIONS ${STM32_CHIP_DEF_CL})

ADD_LIBRARY(bm_delay_stm32spl_hd ${BAREMETAL_DELAY_SOURCES})
SET_TARGET_PROPERTIES(bm_delay_stm32spl_hd PROPERTIES COMPILE_DEFINITIONS ${STM32_CHIP_DEF_HD})

ADD_LIBRARY(bm_delay_stm32spl_hd_vl ${BAREMETAL_DELAY_SOURCES})
SET_TARGET_PROPERTIES(bm_delay_stm32spl_hd_vl PROPERTIES COMPILE_DEFINITIONS ${STM32_CHIP_DEF_HD_VL})

ADD_LIBRARY(bm_delay_stm32spl_ld ${BAREMETAL_DELAY_SOURCES})
SET_TARGET_PROPERTIES(bm_delay_stm32spl_ld PROPERTIES COMPILE_DEFINITIONS ${STM32_CHIP_DEF_LD})

ADD_LIBRARY(bm_delay_stm32spl_ld_vl ${BAREMETAL_DELAY_SOURCES})
SET_TARGET_PROPERTIES(bm_delay_stm32spl_ld_vl PROPERTIES COMPILE_DEFINITIONS ${STM32_CHIP_DEF_LD_VL})

ADD_LIBRARY(bm_delay_stm32spl_md ${BAREMETAL_DELAY_SOURCES})
SET_TARGET_PROPERTIES(bm_delay_stm32spl_md PROPERTIES COMPILE_DEFINITIONS ${STM32_CHIP_DEF_MD})

ADD_LIBRARY(bm_delay_stm32spl_md_vl ${BAREMETAL_DELAY_SOURCES})
SET_TARGET_PROPERTIES(bm_delay_stm32spl_md_vl PROPERTIES COMPILE_DEFINITIONS ${STM32_CHIP_DEF_MD_VL})

ADD_LIBRARY(bm_delay_stm32spl_xl ${BAREMETAL_DELAY_SOURCES})
SET_TARGET_PROPERTIES(bm_delay_stm32spl_xl PROPERTIES COMPILE_DEFINITIONS ${STM32_CHIP_DEF_XL})


INSTALL(TARGETS bm_delay_stm32spl_cl bm_delay_stm32spl_hd bm_delay_stm32spl_hd_vl bm_delay_stm32spl_md bm_delay_stm32spl_md_vl bm_delay_stm32spl_ld bm_delay_stm32spl_ld_vl bm_delay_stm32spl_xl
        RUNTIME DESTINATION bin LIBRARY DESTINATION lib ARCHIVE DESTINATION lib)